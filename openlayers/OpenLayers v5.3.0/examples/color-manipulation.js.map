{"version":3,"sources":["webpack:///./color-manipulation.js"],"names":["const","let"],"mappings":"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","file":"color-manipulation.js","sourcesContent":["import Map from '../src/ol/Map.js';\nimport View from '../src/ol/View.js';\nimport ImageLayer from '../src/ol/layer/Image.js';\nimport {Raster as RasterSource, Stamen} from '../src/ol/source.js';\n\n\n/**\n * Color manipulation functions below are adapted from\n * https://github.com/d3/d3-color.\n */\nconst Xn = 0.950470;\nconst Yn = 1;\nconst Zn = 1.088830;\nconst t0 = 4 / 29;\nconst t1 = 6 / 29;\nconst t2 = 3 * t1 * t1;\nconst t3 = t1 * t1 * t1;\nconst twoPi = 2 * Math.PI;\n\n\n/**\n * Convert an RGB pixel into an HCL pixel.\n * @param {Array<number>} pixel A pixel in RGB space.\n * @return {Array<number>} A pixel in HCL space.\n */\nfunction rgb2hcl(pixel) {\n  const red = rgb2xyz(pixel[0]);\n  const green = rgb2xyz(pixel[1]);\n  const blue = rgb2xyz(pixel[2]);\n\n  const x = xyz2lab(\n    (0.4124564 * red + 0.3575761 * green + 0.1804375 * blue) / Xn);\n  const y = xyz2lab(\n    (0.2126729 * red + 0.7151522 * green + 0.0721750 * blue) / Yn);\n  const z = xyz2lab(\n    (0.0193339 * red + 0.1191920 * green + 0.9503041 * blue) / Zn);\n\n  const l = 116 * y - 16;\n  const a = 500 * (x - y);\n  const b = 200 * (y - z);\n\n  const c = Math.sqrt(a * a + b * b);\n  let h = Math.atan2(b, a);\n  if (h < 0) {\n    h += twoPi;\n  }\n\n  pixel[0] = h;\n  pixel[1] = c;\n  pixel[2] = l;\n\n  return pixel;\n}\n\n\n/**\n * Convert an HCL pixel into an RGB pixel.\n * @param {Array<number>} pixel A pixel in HCL space.\n * @return {Array<number>} A pixel in RGB space.\n */\nfunction hcl2rgb(pixel) {\n  const h = pixel[0];\n  const c = pixel[1];\n  const l = pixel[2];\n\n  const a = Math.cos(h) * c;\n  const b = Math.sin(h) * c;\n\n  let y = (l + 16) / 116;\n  let x = isNaN(a) ? y : y + a / 500;\n  let z = isNaN(b) ? y : y - b / 200;\n\n  y = Yn * lab2xyz(y);\n  x = Xn * lab2xyz(x);\n  z = Zn * lab2xyz(z);\n\n  pixel[0] = xyz2rgb(3.2404542 * x - 1.5371385 * y - 0.4985314 * z);\n  pixel[1] = xyz2rgb(-0.9692660 * x + 1.8760108 * y + 0.0415560 * z);\n  pixel[2] = xyz2rgb(0.0556434 * x - 0.2040259 * y + 1.0572252 * z);\n\n  return pixel;\n}\n\nfunction xyz2lab(t) {\n  return t > t3 ? Math.pow(t, 1 / 3) : t / t2 + t0;\n}\n\nfunction lab2xyz(t) {\n  return t > t1 ? t * t * t : t2 * (t - t0);\n}\n\nfunction rgb2xyz(x) {\n  return (x /= 255) <= 0.04045 ? x / 12.92 : Math.pow((x + 0.055) / 1.055, 2.4);\n}\n\nfunction xyz2rgb(x) {\n  return 255 * (x <= 0.0031308 ?\n    12.92 * x : 1.055 * Math.pow(x, 1 / 2.4) - 0.055);\n}\n\nconst raster = new RasterSource({\n  sources: [new Stamen({\n    layer: 'watercolor',\n    transition: 0\n  })],\n  operation: function(pixels, data) {\n    const hcl = rgb2hcl(pixels[0]);\n\n    let h = hcl[0] + Math.PI * data.hue / 180;\n    if (h < 0) {\n      h += twoPi;\n    } else if (h > twoPi) {\n      h -= twoPi;\n    }\n    hcl[0] = h;\n\n    hcl[1] *= (data.chroma / 100);\n    hcl[2] *= (data.lightness / 100);\n\n    return hcl2rgb(hcl);\n  },\n  lib: {\n    rgb2hcl: rgb2hcl,\n    hcl2rgb: hcl2rgb,\n    rgb2xyz: rgb2xyz,\n    lab2xyz: lab2xyz,\n    xyz2lab: xyz2lab,\n    xyz2rgb: xyz2rgb,\n    Xn: Xn,\n    Yn: Yn,\n    Zn: Zn,\n    t0: t0,\n    t1: t1,\n    t2: t2,\n    t3: t3,\n    twoPi: twoPi\n  }\n});\n\nconst controls = {};\n\nraster.on('beforeoperations', function(event) {\n  const data = event.data;\n  for (const id in controls) {\n    data[id] = Number(controls[id].value);\n  }\n});\n\nconst map = new Map({\n  layers: [\n    new ImageLayer({\n      source: raster\n    })\n  ],\n  target: 'map',\n  view: new View({\n    center: [0, 2500000],\n    zoom: 2,\n    maxZoom: 18\n  })\n});\n\nconst controlIds = ['hue', 'chroma', 'lightness'];\ncontrolIds.forEach(function(id) {\n  const control = document.getElementById(id);\n  const output = document.getElementById(id + 'Out');\n  control.addEventListener('input', function() {\n    output.innerText = control.value;\n    raster.changed();\n  });\n  output.innerText = control.value;\n  controls[id] = control;\n});\n"],"sourceRoot":""}