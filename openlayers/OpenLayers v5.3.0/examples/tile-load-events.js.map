{"version":3,"sources":["webpack:///./tile-load-events.js"],"names":["__webpack_require__","r","__webpack_exports__","_src_ol_Map_js__WEBPACK_IMPORTED_MODULE_0__","_src_ol_View_js__WEBPACK_IMPORTED_MODULE_1__","_src_ol_layer_Tile_js__WEBPACK_IMPORTED_MODULE_2__","_src_ol_source_TileJSON_js__WEBPACK_IMPORTED_MODULE_3__","Progress","el","this","loading","loaded","prototype","addLoading","show","update","addLoaded","const","this_","setTimeout","width","toFixed","style","hide","visibility","progress","document","getElementById","source","url","crossOrigin","on","layers","target","view","center","zoom"],"mappings":"4FAAAA,EAAAC,EAAAC,GAAA,IAAAC,EAAAH,EAAA,GAAAI,EAAAJ,EAAA,GAAAK,EAAAL,EAAA,GAAAM,EAAAN,EAAA,IAWA,SAASO,EAASC,GAChBC,KAAKD,GAAKA,EACVC,KAAKC,QAAU,EACfD,KAAKE,OAAS,EAOhBJ,EAASK,UAAUC,WAAa,WACT,IAAjBJ,KAAKC,SACPD,KAAKK,SAELL,KAAKC,QACPD,KAAKM,UAOPR,EAASK,UAAUI,UAAY,WAC7BC,IAAMC,EAAQT,KACdU,WAAW,aACPD,EAAMP,OACRO,EAAMH,UACL,MAOLR,EAASK,UAAUG,OAAS,WAC1BE,IAAMG,GAASX,KAAKE,OAASF,KAAKC,QAAU,KAAKW,QAAQ,GAAK,IAE9D,GADAZ,KAAKD,GAAGc,MAAMF,MAAQA,EAClBX,KAAKC,UAAYD,KAAKE,OAAQ,CAChCF,KAAKC,QAAU,EACfD,KAAKE,OAAS,EACdM,IAAMC,EAAQT,KACdU,WAAW,WACTD,EAAMK,QACL,OAQPhB,EAASK,UAAUE,KAAO,WACxBL,KAAKD,GAAGc,MAAME,WAAa,WAO7BjB,EAASK,UAAUW,KAAO,WACpBd,KAAKC,UAAYD,KAAKE,SACxBF,KAAKD,GAAGc,MAAME,WAAa,SAC3Bf,KAAKD,GAAGc,MAAMF,MAAQ,IAI1BH,IAAMQ,EAAW,IAAIlB,EAASmB,SAASC,eAAe,aAEhDC,EAAS,IAAItB,EAAA,EAAS,CAC1BuB,IAAK,kEACLC,YAAa,cAGfF,EAAOG,GAAG,gBAAiB,WACzBN,EAASZ,eAGXe,EAAOG,GAAG,cAAe,WACvBN,EAAST,cAEXY,EAAOG,GAAG,gBAAiB,WACzBN,EAAST,cAGC,IAAIb,EAAA,EAAI,CAClB6B,OAAQ,CACN,IAAI3B,EAAA,EAAU,CAACuB,OAAQA,KAEzBK,OAAQ,MACRC,KAAM,IAAI9B,EAAA,EAAK,CACb+B,OAAQ,CAAC,EAAG,GACZC,KAAM","file":"tile-load-events.js","sourcesContent":["import Map from '../src/ol/Map.js';\nimport View from '../src/ol/View.js';\nimport TileLayer from '../src/ol/layer/Tile.js';\nimport TileJSON from '../src/ol/source/TileJSON.js';\n\n\n/**\n * Renders a progress bar.\n * @param {Element} el The target element.\n * @constructor\n */\nfunction Progress(el) {\n  this.el = el;\n  this.loading = 0;\n  this.loaded = 0;\n}\n\n\n/**\n * Increment the count of loading tiles.\n */\nProgress.prototype.addLoading = function() {\n  if (this.loading === 0) {\n    this.show();\n  }\n  ++this.loading;\n  this.update();\n};\n\n\n/**\n * Increment the count of loaded tiles.\n */\nProgress.prototype.addLoaded = function() {\n  const this_ = this;\n  setTimeout(function() {\n    ++this_.loaded;\n    this_.update();\n  }, 100);\n};\n\n\n/**\n * Update the progress bar.\n */\nProgress.prototype.update = function() {\n  const width = (this.loaded / this.loading * 100).toFixed(1) + '%';\n  this.el.style.width = width;\n  if (this.loading === this.loaded) {\n    this.loading = 0;\n    this.loaded = 0;\n    const this_ = this;\n    setTimeout(function() {\n      this_.hide();\n    }, 500);\n  }\n};\n\n\n/**\n * Show the progress bar.\n */\nProgress.prototype.show = function() {\n  this.el.style.visibility = 'visible';\n};\n\n\n/**\n * Hide the progress bar.\n */\nProgress.prototype.hide = function() {\n  if (this.loading === this.loaded) {\n    this.el.style.visibility = 'hidden';\n    this.el.style.width = 0;\n  }\n};\n\nconst progress = new Progress(document.getElementById('progress'));\n\nconst source = new TileJSON({\n  url: 'https://api.tiles.mapbox.com/v3/mapbox.world-bright.json?secure',\n  crossOrigin: 'anonymous'\n});\n\nsource.on('tileloadstart', function() {\n  progress.addLoading();\n});\n\nsource.on('tileloadend', function() {\n  progress.addLoaded();\n});\nsource.on('tileloaderror', function() {\n  progress.addLoaded();\n});\n\nconst map = new Map({\n  layers: [\n    new TileLayer({source: source})\n  ],\n  target: 'map',\n  view: new View({\n    center: [0, 0],\n    zoom: 2\n  })\n});\n"],"sourceRoot":""}